<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js" integrity="sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY" crossorigin="anonymous"></script>
    <script src="/UNIMATH_LATEX.js" crossorigin="anonymous"></script>
	<title>Homework Helper</title>
</head>
<body>
	<style>
		.font-monospace {
			font-family: monospace;
		}

		main {
			padding: 3em;
			padding-right: 0px;
			overflow-x: hidden;
		}

		.font-monospace input {
			border: none;
			font-family: monospace;
			background-color: transparent;
			width: 6em;
		}

		.font-monospace select {
			border: none;
			font-family: monospace;
			width: 6em;
			background-color: transparent;
		}

		.no-render {
			display: none;
		}

		.katex { font-size: 1em !important; }
	</style>

	<main>
		<div>
			<h3>Solve quadratic</h3>
			<div class="font-monospace">
				Q: <span id="_S-q--Q"></span><br/>
				f: <select id="_S-q-f" oninput="sU_q();">
					<option value="eq">=</option>
					<option value="gt">&gt;</option>
					<option value="lt">&lt;</option>
					<option value="ge">&ge;</option>
					<option value="le">&le;</option>
				</select><br/>
				a: <input id="_S-q-a" type="number" value="1" oninput="sU_q();"><br/>
				b: <input id="_S-q-b" type="number" value="0" oninput="sU_q();"><br/>
				c: <input id="_S-q-c" type="number" value="0" oninput="sU_q();"><br/>
				D: <span id="_S-q--D"></span><br/>
				<div class="no-render">x &isin; <span id="_S-q--A"></span><br/></div>
				x &isin; <span id="_S-q--Ax"></span><br/>
				
				<canvas id="_S-q--E" width="400" height="50"></canvas>
			</div>

		</div>
	</main>

	<script defer>
		const Q = document.querySelector.bind(document);

		const E = {
			q: {
				Q: Q("#_S-q--Q"),
				a: Q("#_S-q-a"),
				b: Q("#_S-q-b"),
				c: Q("#_S-q-c"),
				f: Q("#_S-q-f"),
				D: Q("#_S-q--D"),
				A: Q("#_S-q--A"),
				Ax: Q("#_S-q--Ax"),
				X: Q("#_S-q--A"),
				E: Q("#_S-q--e"),
			}
		};

		function sU_q() {
			const a = Number.parseFloat(E.q.a.value);
			const b = Number.parseFloat(E.q.b.value);
			const c = Number.parseFloat(E.q.c.value);

			const sQ_s = [a,b,c].map(x=>x>0?'+':'-');
			const sQ_sc = [a,b].map(c=>c==1?``:Math.abs(c));
			const sQs = [`${sQ_sc[0]}x²`,`${sQ_s[1]} ${sQ_sc[1]}x`,`${sQ_s[2]} ${Math.abs(c)}`];
			const sQ = sQs.filter((_,i)=>[a,b,c][i]!=0).join(' ');
			
			const D = b ** 2 - 4 * a * c;
			const sD = `${b ** 2} ${a*c<0?'+':'-'} ${[4,a,c]
			.map(Math.abs).filter(x=>x!=1).join(' · ')}`;

			const R=f=>(...p)=>f(f,...p);
			const D_u=(v,d)=>v<1&&v>0?d:v;
			const W_F=(a,b,s)=>(g=>`${s<0?'-':'+'}\\frac{${a/g}}{${b/g}}`)(D_u(R((f,a,b)=>b?f(f,b,a%b):a)(a,b),1));
			const W=(a,b)=>`${a/b}`.length<6?[a/b,`${a/b}`]:[a/b,W_F(Math.abs(a),Math.abs(b),Math.sign(a*b))];
			const a2=a*2,g=[W(-b+Math.sqrt(D),a2),W(-b-Math.sqrt(D),a2)]
			.sort(([_,a],[__,b])=>a-b).map(x=>x[1]);
			const A={eq:()=>D<0?`∅`:D==0?`{${g[0]}}`:D>0?g.join(', '):`{NaN}`,
			lt:()=>D<0?`∅`:D==0?`∅`:D>0?`(${g[0]};${g[1]})`:`{NaN}`,
			gt:()=>D<0?`∅`:D==0?`∅`:D>0?`(-∞;${g[0]}) ∪ (${g[1]};∞)`:`{NaN}`,
			le:()=>D<0?`∅`:D==0?`{${g[0]}}`:D>0?`[${g[0]};${g[1]}]`:`{NaN}`,
			ge:()=>D<0?`∅`:D==0?`{${g[0]}}`:D>0?`(-∞;${g[0]}] ∪ [${g[1]};∞)`:`{NaN}`,
			}[E.q.f.value]();

			E.q.Q.innerText = `${sQ} ${(Object.fromEntries("eq.=|lt.<|gt.>|le.≤|ge.≥"
			.split('|').map(x=>x.split('.'))))[E.q.f.value]} 0`;
			E.q.D.innerText = `${sD} = ${D}`;
			E.q.A.innerText = A;
			E.q.A.innerText = A;
			katex.render(unimath_latex.conv(A), E.q.Ax, {output:'html'})
		}

		sU_q();
	</script>
</body>
</html>
